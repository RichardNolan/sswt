<% if customer_signed_in? && current_customer.id %>
<h3 class="text-center">My Orders</h3>
<% end %>

<% if admin_signed_in? %>
<h3 class="text-center">All Orders</h3>
<% end %>


<div class="container">

  <div class="card">

    <table class="table table-striped">
      <thead>
        <tr>
          <% if admin_signed_in? %>
            <th>Customer</th>
          <% end %>
          <th>Order ID:</th>          
          <th>Total</th>
          <th>Date</th>
          <th>&nbsp;</th>
        </tr>
      </thead>

      <tbody>
        <% @orders.each do |order| %>
          <tr>            
            <% if admin_signed_in? %>
            <td>
              <%= link_to(order.customer) do %>
                <strong><%= "#{order.customer.first_name} #{order.customer.last_name}" %></strong><br>
                <%= order.customer.email %>
              <% end %>              
            </td>
            <% end %>
            <td><%= order.id %></td>
            <td><%= currency(order.price/100) %></td>
            <td><%= order.created_at.strftime("%Y/%m/%d at %I:%M%p") %></td>
            <td>
              <button class="btn btn-sm btn-primary" onclick="openOrderModal(<%= order.id %>)">Details</button>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>

  </div>
</div>



<script type="text/javascript">
  
    // Open Order Modal
    var modal_order_id = 0;
    function openOrderModal(order_id) {
      modal_order_id = order_id;
      $('#modal-ajax-content').html('<div class="loader"></div>')
      $('#orderModal').modal();
    }

</script>